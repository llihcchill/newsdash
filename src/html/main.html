<!DOCTYPE html>

<html>
    <head>
        <script src="/static/htmx.min.js"></script>
    </head>

    <body>
        <main id="main">
            <log-in name="world"></log-in>
        </main>

        
        <script type="module" id="main-s">

        //**************************************************************************************************
        // might eventually split this up but due to import MIME type issues I'll be developing it like this
        //**************************************************************************************************

        import {LitElement, html, css} from "https://cdn.jsdelivr.net/gh/lit/dist@3/core/lit-core.min.js";
        // using CDN because of above ^^^
        // at least it's one less build tool \o/

        // locally stores about-to-be-given username
        let username;

        export class Login extends LitElement {
            // scoped css here
            static styles = css``;
                    
            constructor() {
                super();
                // reactive properties here
            }

            formSubmit(e) {
                e.preventDefault();

                // transform form into object to then get data from
                const form = e.target;
                const formData = new FormData(form);
                const formValues = Object.fromEntries(formData.entries());

                username = formValues.username;

                // send to server-select page without full page refresh
                htmx.ajax("GET", "/server-select", {target: "#form", swap: "innerHTML"});
            }
                
            // render component
            render() {
            return html`
                <h1>
                    NewsDash
                </h1>
                <div id="form">
                    <form @submit=${this.formSubmit}>
                        <input name="username" type="text">
                        <button type="submit">Submit</button>
                    </form>
                </div>
                `;
            }

            // remove shadow DOM to keep NewsDash title rendered
            createRenderRoot() {
                return this;
            }
        }
        customElements.define('log-in', Login);
        </script>
    </body>
</html>
